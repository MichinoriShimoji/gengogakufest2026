<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>情報密度（サプライザル）の計算方法と解説</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Source+Sans+3:ital,wght@0,300;0,400;0,600;0,700;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:#faf8f5;--bg-card:#fff;--text:#2c2416;--text-muted:#7a6e5d;--text-light:#a89b8a;
    --accent:#b44d2d;--accent-light:#e8d5cc;--accent2:#2d6b5a;--accent2-light:#d4e8e0;
    --blue:#2d5a8c;--blue-light:#d4e0ec;--purple:#7a4d8c;--purple-light:#e4d4ec;
    --border:#e5ded4;--border-light:#f0ebe3;--highlight:#fff8e1;
    --shadow:0 1px 3px rgba(44,36,22,0.06),0 4px 12px rgba(44,36,22,0.04);--radius:6px;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Source Sans 3','Noto Serif JP',sans-serif;background:var(--bg);color:var(--text);font-size:16px;line-height:1.8;-webkit-font-smoothing:antialiased;}
  .page{max-width:860px;margin:0 auto;padding:60px 32px 120px;}

  header{margin-bottom:56px;padding-bottom:32px;border-bottom:2px solid var(--accent);}
  header h1{font-family:'Noto Serif JP',serif;font-size:26px;font-weight:700;letter-spacing:0.02em;margin-bottom:8px;}
  header .subtitle{font-size:17px;color:var(--text-muted);font-weight:300;}
  header .related{margin-top:12px;font-size:13px;color:var(--text-light);}
  header .related a{color:var(--accent);text-decoration:none;border-bottom:1px dotted var(--accent);}

  nav.toc{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:20px 28px;margin-bottom:48px;box-shadow:var(--shadow);}
  nav.toc h2{font-family:'Noto Serif JP',serif;font-size:14px;font-weight:700;text-transform:uppercase;letter-spacing:0.1em;color:var(--text-muted);margin-bottom:12px;}
  nav.toc ol{list-style:none;counter-reset:toc;}
  nav.toc>ol>li{counter-increment:toc;margin-bottom:4px;}
  nav.toc>ol>li::before{content:counter(toc)".";font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--accent);margin-right:8px;font-weight:500;}
  nav.toc a{color:var(--text);text-decoration:none;font-size:15px;}
  nav.toc a:hover{color:var(--accent);}

  section{margin-bottom:48px;}
  section h2{font-family:'Noto Serif JP',serif;font-size:21px;font-weight:700;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid var(--border);}
  section h2 .num{font-family:'JetBrains Mono',monospace;font-size:15px;color:var(--accent);margin-right:8px;}
  section h3{font-size:17px;font-weight:600;margin:24px 0 10px;}
  section h3 .subnum{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--text-muted);margin-right:6px;}
  p{margin-bottom:14px;}

  .finding{background:var(--highlight);border-left:3px solid var(--accent);padding:14px 18px;border-radius:0 var(--radius) var(--radius) 0;margin:18px 0;font-size:15px;}
  .finding.green{background:var(--accent2-light);border-left-color:var(--accent2);}
  .finding.blue{background:var(--blue-light);border-left-color:var(--blue);}

  .table-wrap{overflow-x:auto;margin:16px 0;border-radius:var(--radius);box-shadow:var(--shadow);}
  table{width:100%;border-collapse:collapse;background:var(--bg-card);font-size:14px;}
  thead th{background:#f5f0e8;font-weight:600;font-size:13px;letter-spacing:0.04em;color:var(--text-muted);padding:10px 14px;text-align:left;border-bottom:2px solid var(--border);white-space:nowrap;}
  thead th.r{text-align:right;}
  tbody td{padding:8px 14px;border-bottom:1px solid var(--border-light);vertical-align:top;}
  tbody td.r{text-align:right;font-family:'JetBrains Mono',monospace;font-size:13px;}
  tbody tr:last-child td{border-bottom:none;}
  tbody tr:hover{background:#faf6ee;}
  tbody tr.highlight{background:var(--highlight);font-weight:600;}
  tbody tr.hl-green{background:var(--accent2-light);}

  .morph{font-family:'JetBrains Mono',monospace;font-size:13px;background:#f0ebe3;padding:1px 5px;border-radius:3px;}
  .morph.mmja{background:var(--accent-light);color:var(--accent);font-weight:500;}
  .morph.unu{background:#dce8f8;color:#3a5d8f;}
  .morph.nau{background:var(--purple-light);color:var(--purple);}
  .morph.hi{background:#fde0d0;color:#a03020;font-weight:500;}

  /* Formula box */
  .formula{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:20px 24px;margin:18px 0;box-shadow:var(--shadow);text-align:center;}
  .formula .math{font-family:'JetBrains Mono',monospace;font-size:17px;margin:12px 0;color:var(--text);}
  .formula .note{font-size:13px;color:var(--text-muted);margin-top:8px;text-align:left;}

  /* Calculation step */
  .calc-steps{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);margin:18px 0;box-shadow:var(--shadow);overflow:hidden;}
  .calc-step{padding:14px 20px;border-bottom:1px solid var(--border-light);display:flex;gap:16px;align-items:baseline;}
  .calc-step:last-child{border-bottom:none;}
  .calc-step .step-num{font-family:'JetBrains Mono',monospace;font-size:13px;color:var(--accent);font-weight:600;min-width:28px;}
  .calc-step .step-label{font-size:14px;color:var(--text-muted);min-width:140px;}
  .calc-step .step-val{font-family:'JetBrains Mono',monospace;font-size:14px;flex:1;}
  .calc-step.result{background:var(--highlight);}
  .calc-step.result .step-val{font-weight:600;color:var(--accent);}

  /* Sentence walkthrough */
  .walkthrough{background:#1e1e1e;border-radius:var(--radius);padding:20px;margin:18px 0;overflow-x:auto;}
  .wt-row{display:flex;gap:4px;align-items:center;padding:3px 0;font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.6;}
  .wt-prev{color:#8ab0d0;min-width:120px;text-align:right;}
  .wt-arrow{color:#555;min-width:24px;text-align:center;}
  .wt-cur{min-width:150px;}
  .wt-cur.normal{color:#d4d4d4;}
  .wt-cur.target{color:#f0a050;font-weight:600;}
  .wt-cur.high{color:#f06060;font-weight:600;}
  .wt-info{color:#7a9a7a;min-width:80px;font-size:12px;}
  .wt-surp{min-width:80px;text-align:right;font-weight:500;}
  .wt-surp.low{color:#70b070;}
  .wt-surp.mid{color:#d0c060;}
  .wt-surp.high{color:#e06050;}
  .wt-surp.vhigh{color:#ff4040;font-weight:700;}
  .wt-bar{min-width:100px;}
  .wt-bar-inner{height:8px;border-radius:4px;transition:width 0.3s;}

  /* Scale diagram */
  .scale{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:20px 24px;margin:18px 0;box-shadow:var(--shadow);}
  .scale-bar{height:32px;border-radius:16px;background:linear-gradient(90deg, #70b070 0%, #d0c060 35%, #e0a050 55%, #e06050 75%, #c03030 100%);position:relative;margin:16px 0 24px;}
  .scale-marker{position:absolute;top:-6px;transform:translateX(-50%);text-align:center;}
  .scale-marker .dot{width:10px;height:10px;border-radius:50%;border:2px solid #fff;box-shadow:0 1px 3px rgba(0,0,0,0.3);margin:0 auto 4px;}
  .scale-marker .lbl{font-family:'JetBrains Mono',monospace;font-size:11px;white-space:nowrap;color:var(--text);}
  .scale-marker .desc{font-size:10px;color:var(--text-muted);white-space:nowrap;}

  [id]{scroll-margin-top:24px;}
  footer{margin-top:64px;padding-top:24px;border-top:1px solid var(--border);font-size:13px;color:var(--text-light);}
  @media(max-width:640px){.page{padding:32px 16px 80px;}header h1{font-size:22px;}.calc-step{flex-wrap:wrap;}.wt-row{flex-wrap:wrap;}}
</style>
</head>
<body>
<div class="page">

<header>
  <h1>情報密度（サプライザル）の計算方法と解説</h1>
  <div class="subtitle">コーパスから「予測しやすさ」を数値化する</div>
  <div class="related">
    関連: <a href="mmja_surprisal_report.html">情報密度分析（全体版）</a> ｜ <a href="mmja_surprisal_by_subtype_report.html">サブタイプ別分析</a>
  </div>
</header>

<nav class="toc">
  <h2>目次</h2>
  <ol>
    <li><a href="#s1">サプライザルとは何か</a></li>
    <li><a href="#s2">計算の手順</a></li>
    <li><a href="#s3">実例①：高頻度 bigram（低サプライザル）</a></li>
    <li><a href="#s4">実例②：低頻度 bigram（高サプライザル）</a></li>
    <li><a href="#s5">サプライザルのスケール感</a></li>
    <li><a href="#s6">実文の全形態素ウォークスルー</a></li>
    <li><a href="#s7">mmja 周辺のサプライザルが意味すること</a></li>
    <li><a href="#s8">技術的な補足</a></li>
  </ol>
</nav>

<!-- ============================================ -->
<section id="s1">
  <h2><span class="num">1.</span> サプライザルとは何か</h2>

  <p>サプライザル (surprisal) とは、ある形態素がその文脈でどれだけ「予測しにくい」かを表す情報理論的な指標。日本語では「驚き度」とも訳される。</p>

  <div class="finding green">
    <strong>直感的な説明:</strong> 「あの人は毎朝コーヒーを ___」の空欄に「飲む」が来たら驚かない（低サプライザル）。「投げる」が来たら驚く（高サプライザル）。この「驚きの度合い」を、コーパス中の共起頻度に基づいて数値化したもの。
  </div>

  <p>サプライザルの単位は<strong>ビット (bits)</strong>。1ビットは「2択のうち1つを当てるのに必要な情報量」に相当する。2ビットなら4択、3ビットなら8択、…と指数的に増える。</p>

  <div class="formula">
    <div class="math">S(w<sub>i</sub>) = −log<sub>2</sub> P(w<sub>i</sub> | w<sub>i−1</sub>)</div>
    <div class="note">
      w<sub>i</sub> = 現在の形態素、w<sub>i−1</sub> = 直前の形態素。<br>
      P(w<sub>i</sub> | w<sub>i−1</sub>) = 直前が w<sub>i−1</sub> だったとき、次に w<sub>i</sub> が来る確率。<br>
      この確率が低いほど（＝予測しにくいほど）サプライザルは高くなる。
    </div>
  </div>
</section>

<!-- ============================================ -->
<section id="s2">
  <h2><span class="num">2.</span> 計算の手順</h2>

  <h3><span class="subnum">2.1</span> Step 1: コーパスから bigram 頻度を数える</h3>
  <p>コーパス内の全ての連続する2形態素のペア（bigram）の出現回数を数える。ただし節境界（EOS, EAC, EQC, Q）でリセットし、各節の先頭は特別な記号 &lt;BOS&gt; を前文脈とする。</p>

  <div class="table-wrap">
    <table>
      <thead><tr><th>統計量</th><th class="r">値</th></tr></thead>
      <tbody>
        <tr><td>総形態素数</td><td class="r">6,412</td></tr>
        <tr><td>異なり形態素数 (V)</td><td class="r">934</td></tr>
        <tr><td>総 bigram トークン数</td><td class="r">6,819</td></tr>
        <tr><td>異なり bigram 数</td><td class="r">3,277</td></tr>
      </tbody>
    </table>
  </div>

  <h3><span class="subnum">2.2</span> Step 2: 条件付き確率を計算する</h3>

  <div class="formula">
    <div class="math">P(w<sub>i</sub> | w<sub>i−1</sub>) = <span style="font-size:14px;">C(w<sub>i−1</sub> → w<sub>i</sub>) + α</span> / <span style="font-size:14px;">C(w<sub>i−1</sub> → *) + α × V</span></div>
    <div class="note">
      C(w<sub>i−1</sub> → w<sub>i</sub>) = この bigram がコーパスに出現した回数<br>
      C(w<sub>i−1</sub> → *) = w<sub>i−1</sub> の後に何かが来た回数の合計<br>
      α = 0.01（Laplace smoothing: 未観測の bigram にも微小な確率を与える）<br>
      V = 934（語彙数。分母の補正に使う）
    </div>
  </div>

  <h3><span class="subnum">2.3</span> Step 3: 対数を取ってサプライザルにする</h3>
  <p>確率 P に −log<sub>2</sub> を適用すると、「確率が半分になるごとに +1 bit」というスケールになる。</p>

  <div class="table-wrap">
    <table>
      <thead><tr><th>確率 P</th><th class="r">サプライザル S (bits)</th><th>直感</th></tr></thead>
      <tbody>
        <tr><td>0.50 (50%)</td><td class="r">1.0</td><td>2択で当たるレベル</td></tr>
        <tr><td>0.25 (25%)</td><td class="r">2.0</td><td>4択で当たるレベル</td></tr>
        <tr><td>0.125 (12.5%)</td><td class="r">3.0</td><td>8択で当たるレベル</td></tr>
        <tr><td>0.0625 (6.25%)</td><td class="r">4.0</td><td>16択で当たるレベル</td></tr>
        <tr><td>0.03 (3%)</td><td class="r">5.0</td><td>約32択で当たるレベル</td></tr>
        <tr><td>0.01 (1%)</td><td class="r">6.6</td><td>100択で当たるレベル</td></tr>
        <tr><td>0.001 (0.1%)</td><td class="r">10.0</td><td>1000択で当たるレベル</td></tr>
      </tbody>
    </table>
  </div>
</section>

<!-- ============================================ -->
<section id="s3">
  <h2><span class="num">3.</span> 実例①：高頻度 bigram（低サプライザル）</h2>

  <p><span class="morph">i</span>[VAFX] → <span class="morph">i</span>[VAFX] という bigram は、動詞の活用語尾 <span class="morph">i</span>(THM) の後にまた <span class="morph">i</span>(SEQ) が来るパターンで、コーパス中で最も頻繁な連鎖の一つ。</p>

  <div class="calc-steps">
    <div class="calc-step">
      <span class="step-num">①</span>
      <span class="step-label">前文脈の総数</span>
      <span class="step-val">C(i → *) = 570 回（i の後に何かが来た回数の合計）</span>
    </div>
    <div class="calc-step">
      <span class="step-num">②</span>
      <span class="step-label">bigram 頻度</span>
      <span class="step-val">C(i → i) = 226 回（i の後に i が来た回数）</span>
    </div>
    <div class="calc-step">
      <span class="step-num">③</span>
      <span class="step-label">条件付き確率</span>
      <span class="step-val">P = (226 + 0.01) / (570 + 0.01 × 934) = 226.01 / 579.34 = 0.3901</span>
    </div>
    <div class="calc-step result">
      <span class="step-num">④</span>
      <span class="step-label">サプライザル</span>
      <span class="step-val">S = −log₂(0.3901) = 1.36 bits</span>
    </div>
  </div>

  <p>i の後に i が来る確率は39%と高いため、サプライザルは1.36 bitsと低い。つまり「全く驚かない」連鎖。</p>
</section>

<!-- ============================================ -->
<section id="s4">
  <h2><span class="num">4.</span> 実例②：低頻度 bigram（高サプライザル）</h2>

  <p><span class="morph mmja">mmja</span> → <span class="morph hi">hiitai</span>[N](兵隊) の場合。mmja の後に「兵隊」という特定の名詞が来るケース。</p>

  <div class="calc-steps">
    <div class="calc-step">
      <span class="step-num">①</span>
      <span class="step-label">前文脈の総数</span>
      <span class="step-val">C(mmja → *) = 141 回（mmja の後に何かが来た総数）</span>
    </div>
    <div class="calc-step">
      <span class="step-num">②</span>
      <span class="step-label">bigram 頻度</span>
      <span class="step-val">C(mmja → hiitai) = 0 回（この組み合わせは未観測）</span>
    </div>
    <div class="calc-step">
      <span class="step-num">③</span>
      <span class="step-label">条件付き確率</span>
      <span class="step-val">P = (0 + 0.01) / (141 + 0.01 × 934) = 0.01 / 150.34 = 0.0000665<br>
      <span style="font-size:12px;color:var(--text-muted);">※ Laplace smoothing により、未観測 bigram にも微小な確率が割り当てられる</span></span>
    </div>
    <div class="calc-step result">
      <span class="step-num">④</span>
      <span class="step-label">サプライザル</span>
      <span class="step-val">S = −log₂(0.0000665) ≈ 13.9 bits</span>
    </div>
  </div>

  <p>mmja の後に hiitai (兵隊) が来る確率はほぼゼロなので、サプライザルは非常に高い。ただし実際の分析では、この値はバックオフ（未観測時に unigram 確率に後退する処理）で調整され、hiitai のコーパス内頻度に基づいて <strong>7.22 bits</strong> となる。</p>

  <div class="finding">
    <strong>比較:</strong> 同じ mmja の後でも、<span class="morph unu">unu</span> が来る場合は S = 4.23 bits（8回観測あり）、<span class="morph hi">hiitai</span> が来る場合は S = 7.22 bits。mmja の後に何が来るかの「予測しやすさ」は形態素ごとに大きく異なる。
  </div>
</section>

<!-- ============================================ -->
<section id="s5">
  <h2><span class="num">5.</span> サプライザルのスケール感</h2>

  <p>本コーパスにおけるサプライザルの分布と、代表的な bigram の位置:</p>

  <div class="scale">
    <div style="display:flex;justify-content:space-between;font-size:12px;color:var(--text-muted);font-family:'JetBrains Mono',monospace;margin-bottom:4px;">
      <span>0 bits</span><span>5 bits</span><span>10+ bits</span>
    </div>
    <div class="scale-bar">
      <!-- markers positioned as percentage of 0-11 range -->
      <div class="scale-marker" style="left:12%"><div class="dot" style="background:#2d6b5a;"></div><div class="lbl">1.36</div><div class="desc">i→i</div></div>
      <div class="scale-marker" style="left:30%"><div class="dot" style="background:#2d5a8c;"></div><div class="lbl">3.30</div><div class="desc">a→mmja</div></div>
      <div class="scale-marker" style="left:41%"><div class="dot" style="background:var(--accent);"></div><div class="lbl">4.50</div><div class="desc">コーパス平均</div></div>
      <div class="scale-marker" style="left:56%"><div class="dot" style="background:#7a4d8c;"></div><div class="lbl">6.22</div><div class="desc">mmja→jarabi</div></div>
      <div class="scale-marker" style="left:66%"><div class="dot" style="background:#c03030;"></div><div class="lbl">7.22</div><div class="desc">mmja→hiitai</div></div>
      <div class="scale-marker" style="left:95%"><div class="dot" style="background:#800;"></div><div class="lbl">10.41</div><div class="desc">BOS→faumunu</div></div>
    </div>
    <div style="height:40px;"></div>
  </div>

  <div class="table-wrap">
    <table>
      <thead><tr><th>bigram</th><th class="r">観測回数</th><th class="r">S (bits)</th><th>解釈</th></tr></thead>
      <tbody>
        <tr class="hl-green"><td><span class="morph">i</span> → <span class="morph">i</span></td><td class="r">226 / 570</td><td class="r">1.36</td><td>非常に予測しやすい（活用語尾の連鎖）</td></tr>
        <tr><td><span class="morph">a</span>[TOP] → <span class="morph mmja">mmja</span></td><td class="r">22 / 208</td><td class="r">3.30</td><td>やや予測しやすい（TOP助詞後のmmja）</td></tr>
        <tr><td><span class="morph mmja">mmja</span> → <span class="morph unu">unu</span></td><td class="r">8 / 141</td><td class="r">4.23</td><td>コーパス平均程度</td></tr>
        <tr><td><span class="morph mmja">mmja</span> → <span class="morph">sjeisjunzidai</span>[N]</td><td class="r">4 / 141</td><td class="r">5.23</td><td>やや予測しにくい</td></tr>
        <tr><td><span class="morph mmja">mmja</span> → <span class="morph">jarabi</span>[N](子供)</td><td class="r">2 / 141</td><td class="r">6.22</td><td>予測しにくい</td></tr>
        <tr class="highlight"><td><span class="morph mmja">mmja</span> → <span class="morph hi">hiitai</span>[N](兵隊)</td><td class="r">0 / 141</td><td class="r">7.22</td><td>かなり予測しにくい（未観測）</td></tr>
        <tr><td>&lt;BOS&gt; → <span class="morph hi">faumunu</span>[N](食べ物)</td><td class="r">0 / 1364</td><td class="r">10.41</td><td>非常に予測しにくい</td></tr>
      </tbody>
    </table>
  </div>

  <p>コーパス全体のサプライザル分布: 平均 4.50 bits, 標準偏差 2.40 bits。25パーセンタイルが2.77、75パーセンタイルが6.01。mmja の直後の平均（6.81 bits）は75パーセンタイルを超えており、「コーパス内の形態素連鎖の上位25%に入る予測困難さ」を意味する。</p>
</section>

<!-- ============================================ -->
<section id="s6">
  <h2><span class="num">6.</span> 実文の全形態素ウォークスルー</h2>

  <h3><span class="subnum">6.1</span> 例文: 「それで mmja 兵隊たち mmja ドドドド…」</h3>

  <p>各形態素の「直前の形態素が与えられたときの予測しにくさ」を色分けで表示:</p>

  <div class="walkthrough">
    <div class="wt-row">
      <span class="wt-prev">&lt;BOS&gt;</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">aidu</span>
      <span class="wt-info">[CONJ] それで</span>
      <span class="wt-surp mid">5.84</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:56%;background:#d0c060;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">aidu</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur target">mmja</span>
      <span class="wt-info">[INTJ] DSC</span>
      <span class="wt-surp low">2.47</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:24%;background:#70b070;"></span></span>
    </div>
    <div class="wt-row" style="background:rgba(240,96,80,0.1);border-radius:4px;">
      <span class="wt-prev" style="color:#f0a050;">mmja</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur high">hiitai</span>
      <span class="wt-info">[N] 兵隊</span>
      <span class="wt-surp vhigh">7.22 ★</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:69%;background:#e06050;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">hiitai</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">taa</span>
      <span class="wt-info">[NAFX] PL</span>
      <span class="wt-surp low">3.49</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:34%;background:#90b060;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">taa</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur target">mmja</span>
      <span class="wt-info">[INTJ] DSC</span>
      <span class="wt-surp low">3.72</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:36%;background:#90b060;"></span></span>
    </div>
    <div class="wt-row" style="background:rgba(240,96,80,0.1);border-radius:4px;">
      <span class="wt-prev" style="color:#f0a050;">mmja</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur high">dodododo…</span>
      <span class="wt-info">[INTJ] ONM</span>
      <span class="wt-surp vhigh">7.22 ★</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:69%;background:#e06050;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">dodododo…</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">tii</span>
      <span class="wt-info">[CJP] QUOT</span>
      <span class="wt-surp low">3.36</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:32%;background:#90b060;"></span></span>
    </div>
    <div style="border-top:1px solid #333;margin:6px 0;"></div>
    <div class="wt-row">
      <span class="wt-prev">&lt;BOS&gt;</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">cc</span>
      <span class="wt-info">[V] 来る</span>
      <span class="wt-surp high">8.42</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:81%;background:#e06050;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">cc</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">i</span>
      <span class="wt-info">[VAFX] THM</span>
      <span class="wt-surp low">0.49</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:5%;background:#60c060;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">i</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">i</span>
      <span class="wt-info">[VAFX] SEQ</span>
      <span class="wt-surp low">1.36</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:13%;background:#70b070;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">i</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur target">mmja</span>
      <span class="wt-info">[INTJ] DSC</span>
      <span class="wt-surp mid">5.09</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:49%;background:#d0c060;"></span></span>
    </div>
  </div>

  <div class="finding">
    パターンが見える: mmja の<strong>直前</strong>は低サプライザル（aidu→mmja = 2.47, taa→mmja = 3.72, i→mmja = 5.09）で、mmja の<strong>直後</strong>に高サプライザルのスパイク（→hiitai = 7.22, →dodododo = 7.22）が来る。話者は予測しやすい環境から mmja を挟んで、予測困難な内容語を産出している。
  </div>

  <h3><span class="subnum">6.2</span> もう一つの例文: 「mmja 運悪く死んでいたら…」</h3>

  <div class="walkthrough">
    <div class="wt-row">
      <span class="wt-prev">&lt;BOS&gt;</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur target">mmja</span>
      <span class="wt-info">[INTJ] DSC</span>
      <span class="wt-surp mid">4.93</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:47%;background:#d0c060;"></span></span>
    </div>
    <div class="wt-row" style="background:rgba(240,96,80,0.1);border-radius:4px;">
      <span class="wt-prev" style="color:#f0a050;">mmja</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur high">unwaruku</span>
      <span class="wt-info">[ADV] 運悪く</span>
      <span class="wt-surp vhigh">7.22 ★</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:69%;background:#e06050;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">unwaruku</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">sɨn</span>
      <span class="wt-info">[V] 死ぬ</span>
      <span class="wt-surp low">3.36</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:32%;background:#90b060;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">sɨn</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">i</span>
      <span class="wt-info">[VAFX] THM</span>
      <span class="wt-surp low">2.83</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:27%;background:#80b060;"></span></span>
    </div>
    <div class="wt-row">
      <span class="wt-prev">i</span>
      <span class="wt-arrow">→</span>
      <span class="wt-cur normal">uk</span>
      <span class="wt-info">[AUX] PROS</span>
      <span class="wt-surp high">8.17</span>
      <span class="wt-bar"><span class="wt-bar-inner" style="width:78%;background:#e06050;"></span></span>
    </div>
  </div>

  <p>ここでも mmja の直後 (→unwaruku) にスパイク。「運悪く」は mmja の後に初めて出現する語で、予測が困難。一方その後の sɨn→i (死ぬ→THM) は活用パターンとして予測しやすい。</p>
</section>

<!-- ============================================ -->
<section id="s7">
  <h2><span class="num">7.</span> mmja 周辺のサプライザルが意味すること</h2>

  <h3><span class="subnum">7.1</span> mmja の「前が低く、後が高い」という非対称性</h3>

  <p>mmja の周辺サプライザル（形態素 bigram）の平均値:</p>

  <div class="table-wrap">
    <table>
      <thead><tr><th>位置</th><th class="r">平均 S̄ (bits)</th><th class="r">コーパス平均</th><th>解釈</th></tr></thead>
      <tbody>
        <tr><td>offset −1（直前）</td><td class="r" style="color:#2d6b5a;font-weight:600;">3.72</td><td class="r">4.50</td><td>平均より低い ← 予測しやすい機能語が多い</td></tr>
        <tr><td>offset 0 (mmja 自身)</td><td class="r">4.20</td><td class="r">4.50</td><td>ほぼ平均 ← mmja は文脈からある程度予測可能</td></tr>
        <tr><td>offset +1（直後）</td><td class="r" style="color:var(--accent);font-weight:600;">6.81</td><td class="r">4.50</td><td>平均より+2.3高い ← 予測困難な内容語</td></tr>
      </tbody>
    </table>
  </div>

  <h3><span class="subnum">7.2</span> なぜこれが「産出計画仮説」の証拠になるか</h3>

  <p>mmja が情報密度の遷移点に現れるということは、話者が次に述べる内容が「言語処理上コストが高い」ことを示唆する。直前が低サプライザル（ISP や VAFX）ということは、話者はそこまでは「自動的に」産出できていた。mmja を挿入することで時間を確保し、高サプライザルの内容語（名詞・動詞・代名詞）を産出する。</p>

  <p>この解釈は以下の事実と整合する:</p>
  <ul style="margin:10px 0 16px 24px;font-size:15px;line-height:2;">
    <li>mmja の直前に ISP (22.9%) や VAFX (21.8%) が多い → 機能語は自動的に産出される</li>
    <li>mmja の直後に N (31.8%), V (24.7%), PRN (12.9%) が多い → 内容語の産出には計画が必要</li>
    <li>mmja の後続形態素は lexically diverse（特定の語に集中しない）→ 次の語の選択が困難</li>
  </ul>

  <h3><span class="subnum">7.3</span> 3形式の違いが意味すること</h3>

  <p><a href="mmja_surprisal_by_subtype_report.html" class="secref">サブタイプ別分析</a>の結果を情報密度の観点から:</p>

  <div class="table-wrap">
    <table>
      <thead><tr><th></th><th class="r">直後 S̄</th><th class="r">前後 Δ</th><th>解釈</th></tr></thead>
      <tbody>
        <tr class="highlight"><td><span class="morph mmja">mmja</span></td><td class="r">6.81</td><td class="r">+2.24</td><td>「これから言うことは予測困難だ」のシグナル</td></tr>
        <tr><td><span class="morph unu">unu</span></td><td class="r">5.69</td><td class="r">+1.57</td><td>「次の名詞を探している」ポーズ</td></tr>
        <tr><td><span class="morph nau">naugara</span></td><td class="r">4.69</td><td class="r">−0.44</td><td>情報密度に関係しない引き延ばし</td></tr>
      </tbody>
    </table>
  </div>

  <p>サプライザルは「話者にとっての産出計画コスト」の代理指標として機能しており、3形式が産出過程の異なる段階に対応していることを裏付ける。</p>
</section>

<!-- ============================================ -->
<section id="s8">
  <h2><span class="num">8.</span> 技術的な補足</h2>

  <h3><span class="subnum">8.1</span> Laplace smoothing</h3>
  <p>α = 0.01 を分子に加算し、α × V を分母に加算する。これにより、コーパスで未観測の bigram（例: mmja → hiitai）にもゼロでない微小な確率を与える。α が小さいほど、観測データに忠実なモデルになる。本分析では α = 0.01 を使用（実質的にほぼ最尤推定に近い）。</p>

  <h3><span class="subnum">8.2</span> 節境界でのリセット</h3>
  <p>節境界（EOS, EAC, EQC, Q）を越えた bigram は数えない。各節の先頭は &lt;BOS&gt; を前文脈とする。これは「節をまたいだ形態素の共起」を除外するため。例えば EAC で終わった節の最後の形態素と、次節の最初の形態素は、文法的には独立した単位であり、bigram として数えるのは不適切。</p>

  <h3><span class="subnum">8.3</span> 限界と注意点</h3>
  <p>本分析のサプライザルはコーパス内部の bigram 頻度のみに基づく。コーパスサイズが6,412形態素と比較的小さいため、低頻度の bigram のサプライザルは不安定になり得る。特に mmja の後続形態素は高い多様性を持つため（141回中、最頻の unu でも8回）、個々の bigram サプライザルの精度は限定的である。分析の強さは個々の値ではなく、<strong>170件の mmja に対する統計的傾向</strong>（平均値の差、Mann-Whitney U 検定）にある。</p>
</section>

<footer>
  <p>データソース: combined_gold_nagahama.json ｜ 言語モデル: corpus-internal morph bigram (Laplace α=0.01, V=934)</p>
</footer>

</div>
</body>
</html>
